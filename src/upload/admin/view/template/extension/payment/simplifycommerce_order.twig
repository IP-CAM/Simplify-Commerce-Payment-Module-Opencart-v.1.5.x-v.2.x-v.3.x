<h2>{{ text_payment_info }}</h2>
<div class="alert alert-success" id="simplify_transaction_msg" style="display:none;"></div>
<table class="table table-striped table-bordered">
	{% for txn in simplifycommerce_order.transactions %}
	<tr>
		<td>{{ text_order_ref }}</td>
		<td>{{ txn.order_id }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_ref }}</td>
		<td>{{ txn.transaction_id }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_type }}</td>
		<td>{{ txn.type }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_status }}</td>
		<td>{{ txn.status }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_amount }}</td>
		<td>{{ txn.amount }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_actions }}</td>
		<td>
			{% if txn.type == 'authorization' %}
				<div>
					<button type="button">{{ button_capture }}</button>
					<button type="button">{{ button_void }}</button>
				</div>
			{% else %}
				<div>
					<span>N/A</span>
				</div>
			{% endif %}
		</td>
	</tr>
	{% endfor %}
</table>

<script type="text/javascript"><!--
    $("#btn_refund").click(function () {
      if (confirm('{{ text_confirm_refund }}')) {
        $.ajax({
          type: 'POST',
          dataType: 'json',
          data: {'order_id': {{ order_id }}, 'amount': $('#refund_amount').val()},
          url: 'index.php?route=extension/payment/worldpay/refund&user_token={{ user_token }}',
          beforeSend: function () {
            $('#btn_refund').hide();
            $('#refund_amount').hide();
            $('#img_loading_refund').show();
            $('#simplify_transaction_msg').hide();
          },
          success: function (data) {
            if (data.error == false) {
              html = '';
              html += '<tr>';
              html += '<td class="text-left">' + data.data.created + '</td>';
              html += '<td class="text-left">refund</td>';
              html += '<td class="text-left">' + data.data.amount + '</td>';
              html += '</tr>';

              $('#worldpay_transactions').append(html);
              $('#worldpay_total_released').text(data.data.total_released);

              if (data.data.refund_status == 1) {
                $('.refund_text').text('{{ text_yes }}');
              } else {
                $('#btn_refund').show();
                $('#refund_amount').val(0.00).show();
              }

              if (data.msg != '') {
                $('#simplify_transaction_msg').empty().html('<i class="fa fa-check-circle"></i> ' + data.msg).fadeIn();
              }
            }
            if (data.error == true) {
              alert(data.msg);
              $('#btn_refund').show();
            }

            $('#img_loading_refund').hide();
          }
        });
      }
    });
//--></script>