<h2>{{ text_payment_txn_info }}</h2>
<div class="" id="simplify_transaction_msg" style="display: none"></div>
{% for txn in simplifycommerce_order.transactions %}
<table class="table table-striped table-bordered">
	<tr>
		<td>{{ text_date_created }}</td>
		<td>{{ txn.date_added }}</td>
	</tr>
	<tr>
		<td>{{ text_order_ref }}</td>
		<td>{{ txn.order_id }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_ref }}</td>
		<td>{{ txn.transaction_id }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_type }}</td>
		<td>{{ txn.type }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_status }}</td>
		<td>{{ txn.status }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_amount }}</td>
		<td>{{ txn.amount }}</td>
	</tr>
	<tr>
		<td>{{ text_txn_actions }}</td>
		<td>
			{% if txn.type == 'authorization' %}
				<div>
					{% if txn.status == 'Open' %}
						<button id="btn_capture" type="button" value="{{ txn.transaction_id }}">{{ button_capture }}</button>
{#						<button id="btn_void" type="button" value="{{ txn.transaction_id }}">{{ button_void }}</button>#}
					{% else %}
						<span>N/A</span>
					{% endif %}
					<span id="img_loading" style="display:none;">
						<i class="fa fa-cog fa-spin fa-lg"></i>
					</span>
				</div>
			{% else %}
				<div>
					<span>N/A</span>
				</div>
			{% endif %}
		</td>
	</tr>
</table>
{% endfor %}

<script type="text/javascript"><!--
	$("#btn_capture").on('click', function (e) {
		if (!confirm('{{ text_confirm_capture }}')) {
			return;
		}
		$.ajax({
			type: 'POST',
			dataType: 'json',
			data: {'order_id': {{ order_id }}, 'txn_id': $(this).val()},
			url: 'index.php?route=extension/payment/simplifycommerce/capture&user_token={{ user_token }}',
			beforeSend: function () {
				$('#simplify_transaction_msg').hide();
				$('#img_loading').show();
				$('#btn_capture').prop('disabled', true);
			},
			success: function (data) {
				$('#simplify_transaction_msg').html(data.msg).show();
				if (data.error === true) {
					$('#simplify_transaction_msg').addClass('alert alert-danger');
					$('#btn_capture').prop('disabled', false);
				} else {
					$('#simplify_transaction_msg').addClass('alert alert-success');
				}
			},
			complete: function () {
				$('#img_loading').hide();
			}
		});
	});
//--></script>
